<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">describe(&quot;Ext.String&quot;, function() {

    describe(&quot;ellipsis&quot;, function() {
        var shortString = &quot;A short string&quot;,
            longString  = &quot;A somewhat longer string&quot;;
        
        it(&quot;should keep short strings intact&quot;, function() {
            expect(Ext.String.ellipsis(shortString, 100)).toEqual(shortString);
        });
        
        it(&quot;should truncate a longer string&quot;, function() {
            expect(Ext.String.ellipsis(longString, 10)).toEqual(&quot;A somew...&quot;);
        });
        
        describe(&quot;word break&quot;, function() {
            var longStringWithDot  = &quot;www.sencha.com&quot;,
                longStringWithExclamationMark = &quot;Yeah!Yeah!Yeah!&quot;,
                longStringWithQuestionMark = &quot;Who?When?What?&quot;;
                           
            it(&quot;should find a word break on ' '&quot;, function() {
                expect(Ext.String.ellipsis(longString, 10, true)).toEqual(&quot;A...&quot;);
            });      
            
            it(&quot;should be able to break on '.'&quot;, function() {
                expect(Ext.String.ellipsis(longStringWithDot, 9, true)).toEqual(&quot;www...&quot;);
            });  
            
            it(&quot;should be able to break on '!'&quot;, function() {
                expect(Ext.String.ellipsis(longStringWithExclamationMark, 9, true)).toEqual(&quot;Yeah...&quot;);
            }); 
            
            it(&quot;should be able to break on '?'&quot;, function() {
                expect(Ext.String.ellipsis(longStringWithQuestionMark, 8, true)).toEqual(&quot;Who...&quot;);
            });       
        });
    });
    
    describe(&quot;escapeRegex&quot;, function() {
        var str;
        
        it(&quot;should escape minus&quot;, function() {
            str = &quot;12 - 175&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;12 \\- 175&quot;);
        });
        
        it(&quot;should escape dot&quot;, function() {
            str = &quot;Brian is in the kitchen.&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;Brian is in the kitchen\\.&quot;);
        });
        
        it(&quot;should escape asterisk&quot;, function() {
            str = &quot;12 * 175&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;12 \\* 175&quot;);
        });
        
        it(&quot;should escape plus&quot;, function() {
            str = &quot;12 + 175&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;12 \\+ 175&quot;);
        });
        
        it(&quot;should escape question mark&quot;, function() {
            str = &quot;What else ?&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;What else \\?&quot;);
        });
        
        it(&quot;should escape caret&quot;, function() {
            str = &quot;^^&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;\\^\\^&quot;);
        });
        
        it(&quot;should escape dollar&quot;, function() {
            str = &quot;500$&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;500\\$&quot;);
        });
        
        it(&quot;should escape open brace&quot;, function() {
            str = &quot;something{stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\{stupid&quot;);
        });
        
        it(&quot;should escape close brace&quot;, function() {
            str = &quot;something}stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\}stupid&quot;);
        });
        
        it(&quot;should escape open bracket&quot;, function() {
            str = &quot;something[stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\[stupid&quot;);
        });
        
        it(&quot;should escape close bracket&quot;, function() {
            str = &quot;something]stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\]stupid&quot;);
        });
        
        it(&quot;should escape open parenthesis&quot;, function() {
            str = &quot;something(stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\(stupid&quot;);
        });
        
        it(&quot;should escape close parenthesis&quot;, function() {
            str = &quot;something)stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\)stupid&quot;);
        });
        
        it(&quot;should escape vertival bar&quot;, function() {
            str = &quot;something|stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\|stupid&quot;);
        });
        
        it(&quot;should escape forward slash&quot;, function() {
            str = &quot;something/stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\/stupid&quot;);
        });
        
        it(&quot;should escape backslash&quot;, function() {
            str = &quot;something\\stupid&quot;;
            expect(Ext.String.escapeRegex(str)).toEqual(&quot;something\\\\stupid&quot;);
        });
    });
    
    describe(&quot;htmlEncode&quot;, function() {
        var str;

        it(&quot;should replace ampersands&quot;, function() {
            str = &quot;Fish &amp; Chips&quot;;
            expect(Ext.String.htmlEncode(str)).toEqual(&quot;Fish &amp;amp; Chips&quot;);
        });
        
        it(&quot;should replace less than&quot;, function() {
            str = &quot;Fish &gt; Chips&quot;;
            expect(Ext.String.htmlEncode(str)).toEqual(&quot;Fish &amp;gt; Chips&quot;);
        });
        
        it(&quot;should replace greater than&quot;, function() {
            str = &quot;Fish &lt; Chips&quot;;
            expect(Ext.String.htmlEncode(str)).toEqual(&quot;Fish &amp;lt; Chips&quot;);
        });
        
        it(&quot;should replace double quote&quot;, function() {
            str = 'Fish &quot; Chips';
            expect(Ext.String.htmlEncode(str)).toEqual(&quot;Fish &amp;quot; Chips&quot;);
        });

        it(&quot;should replace apostraphes&quot;, function() {
            str = &quot;Fish ' Chips&quot;;
            expect(Ext.String.htmlEncode(str)).toEqual(&quot;Fish &amp;#39; Chips&quot;);
        });

        describe(&quot;adding character entities&quot;, function(){

            var src = &quot;A string with entities: èÜçñ¶&quot;,
                encoded = &quot;A string with entities: &amp;egrave;&amp;Uuml;&amp;ccedil;&amp;ntilde;&amp;para;&quot;;

            beforeEach(function(){
                Ext.String.addCharacterEntities({
                    '&amp;Uuml;':'\u00dc',
                    '&amp;ccedil;':'\u00e7',
                    '&amp;ntilde;':'ñ',
                    '&amp;egrave;':'è',
                    '&amp;para;':'¶'
                });
            });

            afterEach(function(){
                Ext.String.resetCharacterEntities();
            });


            it(&quot;should allow extending the character entity set&quot;, function(){
                expect(Ext.String.htmlEncode(src)).toBe(encoded);
            });
        });
    });
    
    describe(&quot;htmlDecode&quot;, function() {
        var str;

        it(&quot;should replace ampersands&quot;, function() {
            str = &quot;Fish &amp;amp; Chips&quot;;
            expect(Ext.String.htmlDecode(str)).toEqual(&quot;Fish &amp; Chips&quot;);
        });
        
        it(&quot;should replace less than&quot;, function() {
            str = &quot;Fish &amp;gt; Chips&quot;;
            expect(Ext.String.htmlDecode(str)).toEqual(&quot;Fish &gt; Chips&quot;);
        });
        
        it(&quot;should replace greater than&quot;, function() {
            str = &quot;Fish &amp;lt; Chips&quot;;
            expect(Ext.String.htmlDecode(str)).toEqual(&quot;Fish &lt; Chips&quot;);
        });
        
        it(&quot;should replace double quote&quot;, function() {
            str = 'Fish &amp;quot; Chips';
            expect(Ext.String.htmlDecode(str)).toEqual('Fish &quot; Chips');
        });

        it(&quot;should replace apostraphes&quot;, function() {
            str = &quot;Fish &amp;#39; Chips&quot;;
            expect(Ext.String.htmlDecode(str)).toEqual(&quot;Fish ' Chips&quot;);
        });

        describe(&quot;adding character entities&quot;, function(){

            var src = &quot;A string with entities: èÜçñ¶&quot;,
                encoded = &quot;A string with entities: &amp;egrave;&amp;Uuml;&amp;ccedil;&amp;ntilde;&amp;para;&quot;;

            beforeEach(function(){
                Ext.String.addCharacterEntities({
                    '&amp;Uuml;':'\u00dc',
                    '&amp;ccedil;':'\u00e7',
                    '&amp;ntilde;':'ñ',
                    '&amp;egrave;':'è',
                    '&amp;para;':'¶'
                });
            });

            afterEach(function(){
                Ext.String.resetCharacterEntities();
            });

            it(&quot;should allow extending the character entity set&quot;, function(){
                expect(Ext.String.htmlDecode(encoded)).toBe(src);
            });
        });
    });
    
    describe(&quot;escaping&quot;, function() {
        it(&quot;should leave an empty string alone&quot;, function() {
            expect(Ext.String.escape('')).toEqual('');
        });
        
        it(&quot;should leave a non-empty string without escapable characters alone&quot;, function() {
            expect(Ext.String.escape('Ed')).toEqual('Ed');
        });
        
        it(&quot;should correctly escape a double backslash&quot;, function() {
            expect(Ext.String.escape(&quot;\\&quot;)).toEqual(&quot;\\\\&quot;);
        });
        
        it(&quot;should correctly escape a single backslash&quot;, function() {
            expect(Ext.String.escape('\'')).toEqual('\\\'');
        });
        
        it(&quot;should correctly escape a mixture of escape and non-escape characters&quot;, function() {
            expect(Ext.String.escape('\'foo\\')).toEqual('\\\'foo\\\\');
        });
    });
    
    describe(&quot;formatting&quot;, function() {
        it(&quot;should leave a string without format parameters alone&quot;, function() {
            expect(Ext.String.format('Ed')).toEqual('Ed');
        });
        
        it(&quot;should ignore arguments that don't map to format params&quot;, function() {
            expect(Ext.String.format(&quot;{0} person&quot;, 1, 123)).toEqual(&quot;1 person&quot;);
        });
        
        it(&quot;should accept several format parameters&quot;, function() {
            expect(Ext.String.format(&quot;{0} person {1}&quot;, 1, 'came')).toEqual('1 person came');
        });
    });
    
    describe(&quot;leftPad&quot;, function() {
        it(&quot;should pad the left side of an empty string&quot;, function() {
            expect(Ext.String.leftPad(&quot;&quot;, 5)).toEqual(&quot;     &quot;);
        });
        
        it(&quot;should pad the left side of a non-empty string&quot;, function() {
            expect(Ext.String.leftPad(&quot;Ed&quot;, 5)).toEqual(&quot;   Ed&quot;);
        });
        
        it(&quot;should not pad a string where the character count already exceeds the pad count&quot;, function() {
            expect(Ext.String.leftPad(&quot;Abraham&quot;, 5)).toEqual(&quot;Abraham&quot;);
        });
        
        it(&quot;should allow a custom padding character&quot;, function() {
            expect(Ext.String.leftPad(&quot;Ed&quot;, 5, &quot;0&quot;)).toEqual(&quot;000Ed&quot;);
        });
    });
    
    describe(&quot;when toggling between two values&quot;, function() {
        it(&quot;should use the first toggle value if the string is not already one of the toggle values&quot;, function() {
            expect(Ext.String.toggle(&quot;Aaron&quot;, &quot;Ed&quot;, &quot;Abe&quot;)).toEqual(&quot;Ed&quot;);
        });
        
        it(&quot;should toggle to the second toggle value if the string is currently the first&quot;, function() {
            expect(Ext.String.toggle(&quot;Ed&quot;, &quot;Ed&quot;, &quot;Abe&quot;)).toEqual(&quot;Abe&quot;);
        });
        
        it(&quot;should toggle to the first toggle value if the string is currently the second&quot;, function() {
            expect(Ext.String.toggle(&quot;Abe&quot;, &quot;Ed&quot;, &quot;Abe&quot;)).toEqual(&quot;Ed&quot;);
        });
    });
    
    describe(&quot;trimming&quot;, function() {
        it(&quot;should not modify an empty string&quot;, function() {
            expect(Ext.String.trim(&quot;&quot;)).toEqual(&quot;&quot;);
        });
        
        it(&quot;should not modify a string with no whitespace&quot;, function() {
            expect(Ext.String.trim(&quot;Abe&quot;)).toEqual(&quot;Abe&quot;);
        });
        
        it(&quot;should trim a whitespace-only string&quot;, function() {
            expect(Ext.String.trim(&quot;     &quot;)).toEqual(&quot;&quot;);
        });
        
        it(&quot;should trim leading whitespace&quot;, function() {
            expect(Ext.String.trim(&quot;  Ed&quot;)).toEqual(&quot;Ed&quot;);
        });
        
        it(&quot;should trim trailing whitespace&quot;, function() {
            expect(Ext.String.trim(&quot;Ed   &quot;)).toEqual(&quot;Ed&quot;);
        });
        
        it(&quot;should trim leading and trailing whitespace&quot;, function() {
            expect(Ext.String.trim(&quot;   Ed  &quot;)).toEqual(&quot;Ed&quot;);
        });
        
        it(&quot;should not trim whitespace between words&quot;, function() {
            expect(Ext.String.trim(&quot;Fish and chips&quot;)).toEqual(&quot;Fish and chips&quot;);
            expect(Ext.String.trim(&quot;   Fish and chips  &quot;)).toEqual(&quot;Fish and chips&quot;);
        });
        
        it(&quot;should trim tabs&quot;, function() {
            expect(Ext.String.trim(&quot;\tEd&quot;)).toEqual(&quot;Ed&quot;);
        });
        
        it(&quot;should trim a mixture of tabs and whitespace&quot;, function() {
            expect(Ext.String.trim(&quot;\tEd   &quot;)).toEqual(&quot;Ed&quot;);
        });
    });
    
    describe(&quot;urlAppend&quot;, function(){
        it(&quot;should leave the string untouched if the second argument is empty&quot;, function(){
            expect(Ext.String.urlAppend('sencha.com')).toEqual('sencha.com');    
        });
        
        it(&quot;should append a ? if one doesn't exist&quot;, function(){
            expect(Ext.String.urlAppend('sencha.com', 'foo=bar')).toEqual('sencha.com?foo=bar');
        });
        
        it(&quot;should append any new values with &amp; if a ? exists&quot;, function(){
            expect(Ext.String.urlAppend('sencha.com?x=y', 'foo=bar')).toEqual('sencha.com?x=y&amp;foo=bar');
        });
    });
    
    describe(&quot;capitalize&quot;, function(){
        it(&quot;should handle an empty string&quot;, function(){
            expect(Ext.String.capitalize('')).toEqual('');
        });
        
        it(&quot;should capitalize the first letter of the string&quot;, function(){
            expect(Ext.String.capitalize('open')).toEqual('Open');
        });
        
        it(&quot;should leave the first letter capitalized if it is already capitalized&quot;, function(){
            expect(Ext.String.capitalize('Closed')).toEqual('Closed');
        });
        
        it(&quot;should capitalize a single letter&quot;, function(){
            expect(Ext.String.capitalize('a')).toEqual('A');
        });
        
        it(&quot;should capitalize even when spaces are included&quot;, function(){
            expect(Ext.String.capitalize('this is a sentence')).toEqual('This is a sentence');
        });
    });

    describe(&quot;uncapitalize&quot;, function(){
        it(&quot;should handle an empty string&quot;, function(){
            expect(Ext.String.uncapitalize('')).toEqual('');
        });
        
        it(&quot;should uncapitalize the first letter of the string&quot;, function(){
            expect(Ext.String.uncapitalize('Foo')).toEqual('foo');
        });
        
        it(&quot;should ignore case in the rest of the string&quot;, function() {
            expect(Ext.String.uncapitalize('FooBar')).toEqual('fooBar'); 
        });
        
        it(&quot;should leave the first letter uncapitalized if it is already uncapitalized&quot;, function(){
            expect(Ext.String.uncapitalize('fooBar')).toEqual('fooBar');
        });
        
        it(&quot;should uncapitalize a single letter&quot;, function(){
            expect(Ext.String.uncapitalize('F')).toEqual('f');
        });

        it(&quot;should uncapitalize even when spaces are included&quot;, function(){
            expect(Ext.String.uncapitalize('This is a sentence')).toEqual('this is a sentence');
        });
    });
    
    describe('repeat', function() {
        it('should return an empty string if count == 0', function() {
            expect(Ext.String.repeat('an ordinary string', 0)).toBe('');
        });
        it('should repeat the pattern as many times as required using the specified separator', function() {
            expect(Ext.String.repeat('an ordinary string', 1, '/')).toBe('an ordinary string');
            expect(Ext.String.repeat('an ordinary string', 2, '&amp;')).toBe('an ordinary string&amp;an ordinary string');
            expect(Ext.String.repeat('an ordinary string', 3, '%')).toBe('an ordinary string%an ordinary string%an ordinary string');
        });
        it('should concatenate the repetitions if no separator is specified', function() {
            expect(Ext.String.repeat('foo', 3)).toBe('foofoofoo');
            expect(Ext.String.repeat('bar baz', 3)).toBe('bar bazbar bazbar baz');
        });
    });

    describe('splitWords', function () {
        it('should handle no args', function () {
            var words = Ext.String.splitWords();
            expect(Ext.encode(words)).toEqual('[]');
        });
        it('should handle null', function () {
            var words = Ext.String.splitWords(null);
            expect(Ext.encode(words)).toEqual('[]');
        });
        it('should handle an empty string', function () {
            var words = Ext.String.splitWords('');
            expect(Ext.encode(words)).toEqual('[]');
        });
        it('should handle one trimmed word', function () {
            var words = Ext.String.splitWords('foo');
            expect(Ext.encode(words)).toEqual('[&quot;foo&quot;]');
        });
        it('should handle one word with spaces around it', function () {
            var words = Ext.String.splitWords(' foo ');
            expect(Ext.encode(words)).toEqual('[&quot;foo&quot;]');
        });
        it('should handle two trimmed words', function () {
            var words = Ext.String.splitWords('foo bar');
            expect(Ext.encode(words)).toEqual('[&quot;foo&quot;,&quot;bar&quot;]');
        });
        it('should handle two untrimmed words', function () {
            var words = Ext.String.splitWords('  foo  bar  ');
            expect(Ext.encode(words)).toEqual('[&quot;foo&quot;,&quot;bar&quot;]');
        });
        it('should handle five trimmed words', function () {
            var words = Ext.String.splitWords('foo bar bif boo foobar');
            expect(Ext.encode(words)).toEqual('[&quot;foo&quot;,&quot;bar&quot;,&quot;bif&quot;,&quot;boo&quot;,&quot;foobar&quot;]');
        });
        it('should handle five untrimmed words', function () {
            var words = Ext.String.splitWords(' foo   bar   bif   boo  foobar    \t');
            expect(Ext.encode(words)).toEqual('[&quot;foo&quot;,&quot;bar&quot;,&quot;bif&quot;,&quot;boo&quot;,&quot;foobar&quot;]');
        });
    })
});
</pre>
</body>
</html>
